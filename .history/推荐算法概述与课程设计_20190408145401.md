## 推荐系统

**背景**；随着互联网的发展，人们逐渐从信息匮乏的时代走入了信息过载的时代，面对海量的信息，用户很难找到自己真正感兴趣的。一个著名的解决方案是搜索引擎技术，用户只需要输入关键字就能得到想要的信息。但很多时候用户的需求并不明确，比如，用户某天因为无聊想看电影，但没有具体的目标，面对着上百年来的无数电影，用户只觉手足无措。而推荐系统能够自动地为用户发现他们可能感兴趣的信息，同时解决信息过载和用户实际需求不明确的问题。

**推荐系统的优势**：在互联网领域发掘长尾分布中的巨大市场（长尾分布：大部分用户需求都集中在头部流行的物品，但分布在尾部的个性化需求利润小但总量更大）对于用户，一千个读者就有一千个哈姆雷特。推荐系统的出现，让每个用户都能拥有私人订制的体验，快速发现自己真正感兴趣的物品。对于内容提供者来说，保证自己生产的每个内容都能被用户所发现。

**推荐系统的应用**：被广泛应用于社交、电子商务、信息流产品、音乐、电影、广告投放等，任何需要提供个性化服务的场景。

### 推荐算法的原理

要搞清楚推荐系统是如何工作的，我们首先回顾一下现实生活中用户在面对很多选择时时如何做出决定的。仍然以看电影为例，一般来说我们可能以如下方式决定最终看什么电影：

1. 向朋友咨询。我们可能会向平时经常看电影的朋友咨询，询问他们的意见，或者在社交平台上发一句“我要看电影的动态”，等待热心网友的推荐。这种方式在推荐系统中被称作**社交化推荐**。
   
2. 我们一般有自己偏爱的导演或者演员，有些人也会有自己偏爱的题材，这时通常的做法是打开一个搜索引擎，寻找这些人导演过或者出演过的电影，或者寻找某个类别下的电影，看看有没有自己感兴趣的。推荐系统将这一过程自动化，在推荐系统中被称作**基于内容的推荐**。

3. 我们还可能查看排行榜，比如豆瓣电影top250。看看大家都喜欢哪些电影，然后找一部广受好评的电影进行观看。但这种方式只能推荐流行的电影缺乏个性，可以进一步扩展，找到和自己历史兴趣相似的用户，看看他们看过的电影，这种方式通常比宽泛的热门排行榜更能符合用户的兴趣，被称为**基于协同过滤的推荐**

从上面的实例可以看出，**推荐系统的本质**是通过各种方式将用户和特定的物品联系起来。和搜索引擎不同，个性化推荐系统不需要顾客主动输入，只需要用户的行为数据和历史信息。

### 推荐算法的评价标准
![](imgs/1.png)

这里重点介绍实验中经常使用的离线评测方法：将用户的历史行为数据进行离线处理，分为测试集和训练集，在训练集中训练模型，最后通过测试集进行评测。

四个评价标准中，用户满意度的获取一般通过在线的方式获取，在离线测试时通常使用前三个指标，现在分别对三个指标进行介绍：

#### 1. 预测准确度

如果知道用户对物品的历史评分

#### 2. 覆盖率

覆盖率是一个内容提供商最为关心的指标，它描述一个推荐系统对物品长尾的发掘能力，最简单的定义是推荐系统中能够推荐出来的物品占总物品的比例。

假设用户的集合为U，推荐系统给每个用户推荐一个长度为N的物品列表R(u).那么推荐系统的覆盖率可以通过下面的公式计算：

$$
Coverage = \frac{\vert\bigcup_{u \in U } R(u)\vert}{I}
$$

以图书推荐为例，图书供应商会很关心他们的书有没有推荐给用户。一个覆盖率为100%的推荐系统会把每个物品都推荐给用户。从上面的定义也可以看出，热门排行榜的推荐覆盖率非常低。一个好的推荐系统除了要用户满意，也要有较高的覆盖率。

``` python
'''
train_matrix: 训练使用的用户行为矩阵
train_matrix: 测试使用的用户行为矩阵
'''
def Coverage(train_matrix, test, get_recommendation):

    
```


#### 3. 新颖度


#### 关于评分预测和TopN推荐的讨论

评分预测一直是推荐系统研究的热点，大多数的推荐系统的理论研究都是基于用户的评分数据，这主要是由于早期的推荐系统研究都是基于用户评分的(著名的movieLens和Netfix比赛数据)，因此很多研究人员都将研究精力集中在优化评分预测的RMSE和MAE上。

但是近年来有专家指出：推荐系统的目的是找到用户可能感兴趣的电影，而不是找到用户看完电影后，可能会给电影评多少分，也许有一部电影，用户看完后会给很高的分数，但是用户会看的可能性非常小，因此，预测用户是否会看一部电影比预测用户看完电影后会给电影评多少分更重要。

在实际的产品使用中，用户的行为数据很多时候都不是明确的评分数据，例如一个音乐应用中，用户不可能对自己听过的每一首歌进行评分。TopN推荐相对于评分预测更符合实际的推荐需求。


### 3. 用户行为数据

为了让


